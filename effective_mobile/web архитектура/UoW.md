### Паттерн UoW: компромиссы

| Плюсы                                      | Минусы                                                                                                    |
|--------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| - Хорошая абстракция над концепцией атомарных операций, и контекстный менеджер позволяет наглядно видеть атомарную группировку блоков кода. | - Ваш ORM, вероятно, уже имеет несколько совершенных абстракций вокруг атомарности, что может привести к избыточности и сложности. |
| - Явный контроль над временем начала и окончания транзакции, и приложение отказывает таким образом, который безопасен по умолчанию. | - Необходимо хорошо подумать о вопросах, таких как откаты, многопоточная обработка и вложенные транзакции. |
| - Хорошее место для размещения всех репозиториев, куда сможет обращаться клиентский код. | - Можно зациклиться на создании собственного UoW, когда уже существуют готовые решения в ORM (например, в SQLAlchemy). |
| - Атомарность помогает работать с транзакциями, событиями и шиной сообщений. | - Может создавать лишние слои абстракции, если используются существующие абстракции ORM. |
### Паттерн Unit of Work (UnitOfWork)

- **Абстракция вокруг целостности данных:** Паттерн UoW является абстракцией вокруг целостности данных и обеспечивает согласованность модели предметной области.

- **Повышение производительности:** Увеличивает производительность, позволяя выполнять одну операцию сброса в конце транзакции.

- **Взаимодействие с другими паттернами:** Тесно взаимодействует с паттернами "Репозиторий" и "Сервисный слой".

- **Атомарные обновления:** Представляет атомарные обновления данных, что позволяет выполнить несколько операций в рамках одного элементарного UoW.

- **Использование контекстного менеджера:** Прекрасная возможность использовать контекстный менеджер для определения области видимости и автоматического отката работы в конце запроса.

- **Реализация в SQLAlchemy:** В SQLAlchemy уже реализован этот паттерн, что обеспечивает более простую абстракцию над объектом класса Session, упрощая интерфейс между ним и исходным кодом.

- **Принцип инверсии зависимостей:** Служба слоя зависит от тонкой абстракции, а конкретная реализация прикрепляется к внешнему краю системы, что согласуется с внутренними рекомендациями SQLAlchemy.
